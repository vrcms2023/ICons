import{r as i,j as e,T as R,B as N,c as f,d as D,F as _e,D as Me,o as we}from"./index-BWK7iHxT.js";import{F as A}from"./FileUpload-BBAUjrX2.js";import{l as Ie}from"./DeleteDialog-DnRfuXBp.js";import{D as Ae}from"./DeleteDialog-sO22D6fc.js";import{C as T}from"./CatageoryImgC-B5Y-umQ5.js";import{E as De}from"./Error-B_8W099F.js";import{C as Be}from"./CRSFToken-fXuQ3seS.js";const He=({title:p,project:o,specifications:d,setSpecifications:m})=>{const u=()=>{m([{title:"",feature:""},...d])},j=(s,n)=>{const{name:b,value:c}=s.target,l=[...d];l[n][b]=c,m(l)},S=s=>{const n=[...d][s],b=async()=>{const c=[...d],l=c[s].id;if(l!==void 0)try{(await f.delete(`/project/deleteSpecifications/${l}/`)).status===204&&(D.success(`${c[s].title} is deleted`),c.splice(s,1))}catch{D.error(`${c[s].title} unable to deleted`)}else c.splice(s,1);m(c)};Ie.confirmAlert({customUI:({onClose:c})=>e.jsx(Ae,{onClose:c,callback:b,projectName:n.title})})};return i.useEffect(()=>{const s=async()=>{var b,c;const n=await f.get(`/project/getSpecification/${o.id}/`);if((n==null?void 0:n.status)===200&&((b=n.data)==null?void 0:b.specification)!==void 0){const l=(c=n==null?void 0:n.data)==null?void 0:c.specification;m(l.reverse())}};o!=null&&o.id&&s()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx(R,{title:p,cssClass:"fs-5 fw-bold"}),d.length>0&&e.jsx(N,{type:"submit",cssClass:"btn float-end btn-success mb-2",label:"ADD",handlerChange:u})]}),e.jsx("hr",{}),e.jsx("div",{className:"",children:e.jsx("table",{className:"table m-0",children:e.jsx("tbody",{children:(d==null?void 0:d.length)>0?d.map((s,n)=>e.jsxs("tr",{children:[e.jsxs("td",{className:"border-bottom  py-5 bg-transparent",children:[e.jsx("input",{type:"text",className:"form-control mb-2",id:"specificationName",placeholder:"Feature title",name:"title",value:s.title?s.title:"",onChange:b=>j(b,n)}),e.jsx("textarea",{className:"form-control",id:"specificationDescription",rows:"3",name:"feature",value:s.feature?s.feature:"",onChange:b=>j(b,n)})]}),e.jsx("td",{className:"align-middle text-center border-bottom bg-transparent",children:e.jsx("i",{className:"fa fa-trash-o fs-3 text-danger","aria-hidden":"true",onClick:()=>S(n),style:{cursor:"pointer"}})})]},n)):e.jsx("tr",{children:e.jsx("td",{children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[e.jsx(N,{type:"submit",cssClass:"btn btn-success mb-2",label:"ADD",handlerChange:u}),e.jsx("p",{className:"text-center text-warning fs-4 m-0",children:'"Click on button to add specifications"'})]})})})})})})]})},Ge=({project:p,amenities:o,setAmenities:d})=>(i.useEffect(()=>{const m=async()=>{try{const u=await f.get(`/project/getAmenitiesById/${p==null?void 0:p.id}/`);(u==null?void 0:u.status)===200&&d(u.data.amenitie)}catch(u){console.log(u)}};p!=null&&p.id&&m()},[]),e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Add Features (Press Enter after every feature) ",value:o==null?void 0:o.feature,amenities:o,setAmenities:d,name:"feature"}),e.jsx(G,{title:"Add Amenities (Press Enter after every amenitie)",value:o==null?void 0:o.amenitie,amenities:o,setAmenities:d,name:"amenitie"})]})),G=({title:p,value:o,amenities:d,setAmenities:m,name:u})=>{const j=(S,s)=>{const{name:n,value:b}=S.target,c={...d};c[n]=b!==""?b:null,m(c)};return e.jsxs(e.Fragment,{children:[e.jsx(R,{title:p,cssClass:"fs-5 fw-bold"}),e.jsx("div",{className:"border border-3 mb-4 shadow-lg",children:e.jsx("textarea",{className:"form-control",name:u,value:o||"",onChange:S=>j(S),id:"amenitiesDescription",rows:"3"})})]})},Xe=()=>{var he;const p=_e(),[o,d]=i.useState(!1),[m,u]=i.useState({}),[j,S]=i.useState(""),[s,n]=i.useState([]),[b,c]=i.useState(""),[l,$]=i.useState({}),[C,J]=i.useState(""),Te={aboutstitle:null,aboutussubtitle:null,description:null,imageDescription:null},[h,K]=i.useState(Te),Fe={title:null,feature:null},Ue={id:"",amenitie:null,feature:null,googleMap:null},[q,z]=i.useState([Fe]),[P,O]=i.useState(Ue),[Q,W]=i.useState([]),[X,Y]=i.useState([]),[Z,ee]=i.useState([]),[te,ae]=i.useState([]),[se,le]=i.useState([]),[re,ie]=i.useState([]),[$e,ce]=i.useState(""),[x,Ee]=i.useState(""),[oe,V]=i.useState(""),[F,L]=i.useState(!1),[ne,I]=i.useState(!1),{id:w}=Me(),[de,pe]=i.useState(null),Oe=[0,10,20,30,40,50,60,70,80,90,100],Ve=a=>{pe(a.target.value)};i.useEffect(()=>{(async()=>{const t=await f.get("/project/categorylist/");(t==null?void 0:t.status)===200?n(t.data):p("/login")})()},[p]),i.useEffect(()=>{Ee(we("userName"))},[]);const be=a=>{c("");const t=a.target.value.toLowerCase(),r=s.filter(v=>v.projectValue===t);r.length>0?u(r):(u({}),c("Please select Project Type"))},me=a=>{V("");const t=a.target.value;S(t)},E=a=>{K({...h,[a.target.name]:a.target.value})},ue=()=>({projectCategoryID:m[0].idprojectcategories,projectCategoryName:m[0].projectLabel,projectCategoryValue:m[0].projectValue}),Le=()=>({aboutstitle:h.aboutstitle,aboutussubtitle:h.aboutussubtitle,description:h.description,imageDescription:h.imageDescription});async function ke(a){if(j===""){V("Please add a project name");return}try{const t=await f.post("/project/addProject/",{...ue(),projectTitle:j,created_by:x,updated_by:x,userID:we("userId"),status:m[0].projectLabel,isActive:!0,publish:!1});if((t==null?void 0:t.status)===400&&c(t.data.message),(t==null?void 0:t.status)===201){const r=t.data;D.success(`${r.projectTitle} Project created`),$(r),ce(r.projectCategoryName),J(r.projectTitle),L(!1),d(!0)}else c(t.data.message)}catch{V(`${j} is already register`),D.error(`${j} is already register`)}}i.useEffect(()=>{w&&(async()=>{const t=await f.get(`/project/editProject/${w}/`);if(t.status!==200&&(c(t.data.message),D.error("Unable to Process your request")),t.status===200){const r=t.data.project;u([{projectLabel:r.projectCategoryName,projectValue:r.projectCategoryValue,idprojectcategories:r.projectCategoryID}]),ce(r.projectCategoryName),$(r),J(r.projectTitle),S(r.projectTitle);const v={aboutstitle:r.aboutstitle,aboutussubtitle:r.aboutussubtitle,description:r.description,imageDescription:r.imageDescription};K(v),pe(r.percentValue?JSON.parse(r.percentValue):null),L(r.publish?JSON.parse(r.publish):!1),d(!0)}else c(t.data.message)})()},[w]);async function ge(){var ve,Ne,Se,Ce;const a={...l,...ue(),...Le(),projectTitle:j,updated_by:x,percentValue:de,publish:F},t=f.put(`/project/editProject/${l.id}/`,a),r={projectID:l.id,updated_by:x,amenitie:P.amenitie,feature:P.feature,googleMap:P.googleMap};let v="";P.id===""?v=f.post("/project/amenities/",r):v=f.put(`/project/getAmenitiesById/${l.id}/`,r);let k=[],_=[];q.forEach(g=>{if(g.id){const y={id:g.id,projectID:l.id,updated_by:x,title:g.title,feature:g.feature};k.push(y)}else{const y={projectID:l.id,updated_by:x,created_by:x,title:g.title,feature:g.feature};_.push(y)}});const M=[t,v];let xe=null,fe=null;_.length>0&&(xe=f.post("/project/specification/",_),M.push(xe)),k.length>0&&(fe=f.put(`/project/updatespecification/${l.id}/`,k),M.push(fe));try{const[g,y,U,B]=await Promise.all(M),Pe=(ve=g==null?void 0:g.data)==null?void 0:ve.project;D.success(`${Pe.projectTitle} Project Update`),S(Pe.projectTitle),O((Ne=y==null?void 0:y.data)==null?void 0:Ne.amenitie);const H=[];ye(H,(Se=U==null?void 0:U.data)==null?void 0:Se.specification),ye(H,(Ce=B==null?void 0:B.data)==null?void 0:Ce.specification),z(H),window.scrollTo(0,0)}catch(g){console.log(g)}function ye(g,y){y&&y.length>0&&y.forEach(U=>{g.push(U)})}}const je=async()=>{const a=async()=>{const t={publish:!F,isActive:!0},r=await f.patch(`/project/publishProject/${l.id}/`,t);if(r.status===200){const v=JSON.parse(r.data.project.publish);L(v),D.success(`${C} ${v?"published":"unPublished"}`)}};Ie.confirmAlert({customUI:({onClose:t})=>e.jsx(Ae,{onClose:t,callback:a,message:`you wish to ${F?"unPublished":"published"} the project without savign your changes`,label:F?"unPublished":"published"})})};return e.jsxs("div",{className:"container-fluid pt-5",children:[e.jsx(Be,{}),e.jsx("div",{className:"row px-3 px-lg-5",children:e.jsxs("div",{className:"text-end d-flex justify-content-between align-items-center flex-column flex-md-row",children:[e.jsx(R,{title:`${w?"Edit Project":"Add Project"}`,cssClass:"text-center blue-500 fs-4 mb-3 mb-md-0"}),e.jsx("div",{className:"d-flex gap-1 justify-content-center align-items-center",children:e.jsx(N,{type:"",cssClass:"btn btn-secondary",label:"Dashboard",handlerChange:()=>p("/dashboard")})})]})}),e.jsx("hr",{}),e.jsxs(e.Fragment,{children:[b?e.jsx(De,{children:b}):"",!w&&!o?e.jsxs("div",{className:"py-2",children:[e.jsxs("select",{className:"form-select shadow-lg border border-2 border-success w-75 m-auto d-block","aria-label":"Default select example",id:"projectStatus",onChange:a=>be(a),children:[e.jsx("option",{children:"Select Project Type"}),s!=null&&s.length?s==null?void 0:s.map((a,t)=>e.jsx("option",{value:a.projectValue,children:a.projectLabel},a.idprojectcategories)):""]}),e.jsx("hr",{})]}):""]}),m.length>0&&!o?e.jsx("div",{className:"row",id:"projectTitle",children:e.jsx("div",{className:"col-md-4 offset-md-4 my-5 ",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"",children:[oe?e.jsx(De,{children:oe}):"",e.jsx("input",{type:"text",className:"form-control",name:"projectName",value:j,onChange:me,id:"projectName",placeholder:"Add project name"}),e.jsxs("div",{className:"d-flex",children:[e.jsx(N,{label:"Cancel",cssClass:"btn btn-outline mt-2 me-2 w-100",handlerChange:()=>{p("/dashboard")}}),e.jsx(N,{label:"Save",cssClass:"btn btn-primary mt-2 ms-2 w-100",handlerChange:ke})]})]}),e.jsx("small",{id:"projectValidation",className:"d-none error",children:"Project name should not be empty."})]})})}):"",o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row bg-light px-3 px-lg-5 mt-3 shadow-lg",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[C&&e.jsxs("h3",{className:"my-4 text-success fs-4",children:[C," ",e.jsx("span",{className:"badge bg-warning text-dark",style:{fontSize:".7rem"},children:$e.toUpperCase()})]}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-1",children:[e.jsx(N,{type:"submit",disabled:ne,cssClass:"btn btn-secondary",label:w?"Update Project":"Save Project",handlerChange:ge}),F?e.jsx(N,{type:"submit",cssClass:"btn btn-sm btn-danger",label:"UNPUBLISH",handlerChange:je}):e.jsx(N,{type:"submit",cssClass:"btn btn-sm btn-success",label:"PUBLISH",handlerChange:je})]})]}),e.jsx("div",{className:"col-md-3 bg-light pb-3",children:e.jsxs("div",{className:"nav flex-column nav-pills ",id:"v-pills-tab",role:"tablist","aria-orientation":"vertical",children:[e.jsx("button",{className:"nav-link active mb-3",id:"v-pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-home",type:"button",role:"tab","aria-controls":"v-pills-home","aria-selected":"true",children:"Info"}),e.jsx("button",{className:"nav-link mb-3",id:"v-pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-profile",type:"button",role:"tab","aria-controls":"v-pills-profile","aria-selected":"false",children:"Pdfs / Plan / Map / Cost / Availability"}),e.jsx("button",{className:"nav-link mb-3",id:"v-pills-messages-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-messages",type:"button",role:"tab","aria-controls":"v-pills-messages","aria-selected":"false",children:"Specifications"}),e.jsx("button",{className:"nav-link mb-3",id:"v-pills-settings-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-settings",type:"button",role:"tab","aria-controls":"v-pills-settings","aria-selected":"false",children:"Features / Amenities"}),e.jsx("button",{className:"nav-link mb-3",id:"v-pills-settings-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-gallery",type:"button",role:"tab","aria-controls":"v-pills-gallery","aria-selected":"false",children:"Image Gallery"})]})}),e.jsx("div",{className:"col-md-9 shadow-lg px-3 py-4 p-md-5 mb-5",children:e.jsxs("div",{className:"tab-content",id:"v-pills-tabContent",children:[e.jsx("div",{className:"tab-pane fade show active",id:"v-pills-home",role:"tabpanel","aria-labelledby":"v-pills-home-tab",children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"projectName",className:"form-label  ",children:"Project Name"}),e.jsx("input",{type:"text",className:"form-control",value:j||"",onChange:me,id:"projectName",placeholder:"Add Project Name"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"projectStatus",className:"form-label  ",children:"Status"}),e.jsxs("select",{value:(he=m[0])==null?void 0:he.projectValue,className:"form-select mb-3 w-100","aria-label":"Default select example",id:"projectStatus",onChange:a=>be(a),children:[e.jsx("option",{children:"Select Status"}),s!=null&&s.length?s==null?void 0:s.map((a,t)=>e.jsx("option",{value:a.projectValue,children:a.projectLabel},a.idprojectcategories)):""]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"projectStatus",className:"form-label  ",children:"Project % Completed"}),e.jsxs("select",{defaultValue:de,className:"form-select mb-3 w-100","aria-label":"Default select example",id:"projectStatus",onChange:a=>Ve(a),children:[e.jsx("option",{value:"Select Status",children:"Select Status"}),Oe.map((a,t)=>e.jsx("option",{value:a,children:a},t))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"projectDescription",className:"form-label",children:"Title"}),e.jsx("input",{type:"text",className:"form-control",name:"aboutstitle",value:h.aboutstitle?h.aboutstitle:"",onChange:E,id:"aboutstitle"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"projectDescription",className:"form-label",children:"Sub Title"}),e.jsx("input",{type:"text",className:"form-control",name:"aboutussubtitle",value:h.aboutussubtitle?h.aboutussubtitle:"",onChange:E,id:"aboutussubtitle"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"projectDescription",className:"form-label  ",children:"Description"}),e.jsx("textarea",{className:"form-control",name:"description",value:h.description?h.description:"",onChange:E,id:"projectDescription",rows:"3"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Project Home Thumbnail"}),e.jsx(A,{project:l,updated_By:x,category:"thumbnail",gallerysetState:Y,galleryState:X,validTypes:"image/png,image/jpeg",descriptionTitle:"Plan Description",showDescription:!1,saveState:I,buttonLable:"Upload Plan",maxFiles:1}),e.jsx(T,{title:`${C} Thumbnail`,catategoryImgs:X,catategoryImgState:Y,project:l,category:"thumbnail",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5"})]})]})}),e.jsxs("div",{className:"tab-pane fade",id:"v-pills-profile",role:"tabpanel","aria-labelledby":"v-pills-profile-tab",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Add PDF's (Upload PDF)"}),e.jsx(A,{project:l,updated_by:x,category:"PDF",gallerysetState:W,galleryState:Q,validTypes:"application/pdf",descriptionTitle:"PDF Description",showDescription:!1,saveState:I,buttonLable:"Upload PDF"}),e.jsx(T,{title:`${C} PDF's`,catategoryImgs:Q,catategoryImgState:W,project:l,category:"PDF",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Add Plan (Upload image)"}),e.jsx(A,{project:l,updated_by:x,category:"Plans",gallerysetState:ee,galleryState:Z,validTypes:"image/png,image/jpeg,application/pdf",descriptionTitle:"Plan Description",showDescription:!1,saveState:I,buttonLable:"Upload Plan"}),e.jsx(T,{title:`${C} Plans`,catategoryImgs:Z,catategoryImgState:ee,project:l,category:"Plans",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Add Availability (Upload image / PDF)"}),e.jsx(A,{project:l,updated_by:x,category:"availability",gallerysetState:ae,galleryState:te,validTypes:"image/png,image/jpeg,application/pdf",descriptionTitle:"Available Description",showDescription:!1,saveState:I,buttonLable:"Upload Availability"}),e.jsx(T,{title:`${C} Availibility`,catategoryImgs:te,catategoryImgState:ae,project:l,category:"availability",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Add Price (Upload image / PDF)"}),e.jsx(A,{title:"",project:l,updated_by:x,category:"price",gallerysetState:le,galleryState:se,validTypes:"image/png,image/jpeg,application/pdf",descriptionTitle:"Price Description",showDescription:!1,saveState:I,buttonLable:"Upload Price Details"}),e.jsx(T,{title:`${C} Price`,catategoryImgs:se,catategoryImgState:le,project:l,category:"price",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"form-label",children:["Add Google Map (Embed a map - source url)"," "]}),e.jsx(G,{title:"",value:P==null?void 0:P.googleMap,amenities:P,setAmenities:O,name:"googleMap"})]})]}),e.jsx("div",{className:"tab-pane fade",id:"v-pills-messages",role:"tabpanel","aria-labelledby":"v-pills-messages-tab",children:e.jsx(He,{title:"Specifications",project:l,setSpecifications:z,specifications:q})}),e.jsx("div",{className:"tab-pane fade",id:"v-pills-settings",role:"tabpanel","aria-labelledby":"v-pills-settings-tab",children:e.jsx(Ge,{project:l,amenities:P,setAmenities:O})}),e.jsxs("div",{className:"tab-pane fade",id:"v-pills-gallery",role:"tabpanel","aria-labelledby":"v-pills-gallery-tab",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"imageDescription",className:"form-label  ",children:"Recent project status description"}),e.jsx("textarea",{rows:4,cols:40,className:"form-control",name:"imageDescription",value:h.imageDescription?h.imageDescription:"",onChange:E,id:"imageDescription"})]}),e.jsx(A,{title:"Add Images",project:l,updated_by:x,category:"images",gallerysetState:ie,galleryState:re,validTypes:"image/png,image/jpeg",descriptionTitle:"Image Description",saveState:I,showDescription:!1}),e.jsx(T,{title:`${C} Image Gallery`,catategoryImgs:re,catategoryImgState:ie,project:l,category:"images",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5"})]})]})})]}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-lg-12 py-4 d-flex gap-1 justify-content-center align-items-center",children:[e.jsx(N,{type:"submit",cssClass:"btn btn btn-secondary",label:"Cancel",handlerChange:()=>p("/dashboard")}),e.jsx(N,{type:"submit",disabled:ne,cssClass:"btn btn-primary",label:w?"Update Project":"Save Project",handlerChange:ge})]})})]}):""]})};export{Xe as default};
