import{f as V,h as Y,r as t,K as ne,j as e,B,O as ae,_ as re,o as J,E as q,u as oe,R as ie,I as le,L as z,c as C,d as O,P as ce,D as de,e as me,i as ue,T as Q,k as pe,M as fe,s as he,Q as xe}from"./index-BWK7iHxT.js";import"./Styled-BriefIntro-DpTy6njT.js";import{B as ge}from"./index-Zr8zxzfx.js";import{I as je}from"./ImgTitleIntoForm-bGCGObUS.js";import{P as be,a as Se}from"./Product-BPfcjYGx.js";import{f as ye,i as M,h as ve,j as we}from"./dynamicFormFields-JEId_5aT.js";import{S as Ne}from"./index-D85sR-zM.js";import{l as K}from"./DeleteDialog-DnRfuXBp.js";import{D as W}from"./DeleteDialog-sO22D6fc.js";import{A as Pe,a as Ee}from"./Styled-ABriefAbout-Dy4kPWQX.js";import{F as Fe}from"./FileUpload-BBAUjrX2.js";import{C as Te}from"./CustomPagination-CzwkxU7w.js";import{E as De}from"./Error-B_8W099F.js";import"./SkeletonImage-DKfKqy0G.js";import"./Styled-PageBanner-gSpUsEd9.js";import"./Ancher-Cr_S9HGk.js";import"./ContactForm-DYVepLWv.js";const Ie=({compState:f,selectedCategory:l,editHandler:g,setResponseData:r,productsList:c,setProductsList:b})=>{const{products:u}=V(i=>i.productList),w=Y();t.useEffect(()=>{l!=null&&l.id&&w(ne(l.id))},[f,l]),t.useEffect(()=>{var i;((i=u==null?void 0:u.results)==null?void 0:i.length)>0?r(u):b([])},[u]);const s=i=>{const{id:p,product_name:h}=i,S=async()=>{if((await ae.delete(`/products/updateProduct/${p}/`)).status===204){const U=c.filter(P=>P.id!==p);b(U)}};K.confirmAlert({customUI:({onClose:y})=>e.jsx(W,{onClose:y,callback:S,message:`deleting the ${h} Product?`})})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"row my-5",children:c==null?void 0:c.map(i=>e.jsx(be,{item:i,editHandler:g,deleteProduct:s},i.id))}),c.length>12&&e.jsx("div",{className:"mt-5 pb-5",children:e.jsx(B,{label:"Load More",cssClass:"btn btn-outline m-auto"})})]})},Re=({category:f,selectedCategory:l,setSelectedCategory:g,setResponseData:r,setPageloadResults:c,setSearchquery:b,searchQuery:u,searchBy:w,hideSearchBy:s})=>{if(f.length===0)return;const i=p=>{const h=re.filter(f,S=>S.id===p.target.value)[0];g(h)};return e.jsx("div",{className:"container position-relative ",children:e.jsxs("div",{className:"row rounded-3 position-absolute overflow-hidden productCategorySearch",children:[e.jsx("div",{className:"col-md-12 px-md-5 productCategory d-flex justify-content-center align-items-center",children:e.jsxs("select",{className:"form-select","aria-label":"Default select example",onChange:i,children:[e.jsx("option",{defaultValue:!0,children:"Open this select menu"}),f.map((p,h)=>e.jsx("option",{selected:p.id===(l==null?void 0:l.id),value:p.id,children:p.category_name},h))]})}),e.jsx("div",{className:"col-md-12 p-0 productSearch d-flex justify-content-center align-items-center",children:e.jsx(Ne,{results:f,setObject:r,clientSearchURL:`/products/productSearch/${l.id}/`,adminSearchURL:`/products/createProduct/${l.id}/`,clientDefaultURL:`/products/productSearch/${l.id}/`,searchfiledDeatails:"Product Name",setPageloadResults:c,setSearchquery:b,searchQuery:u,searchBy:w||"Search By",hideSearchBy:s})})]})})},Ue=({editHandler:f,componentType:l,componentTitle:g,extraFormParamas:r,showExtraFormFields:c,imageLabel:b="Add Image",imagePostURL:u,imageGetURL:w,imageUpdateURL:s,imageDeleteURL:i,pageType:p,type:h,selectedItem:S,setSelectedItemState:y,showDescription:U=!0,dimensions:P,scrollEnable:j})=>{const _="a62d7759-a e6b-4e49-a129-1ee208c6789d",[A,L]=t.useState(""),[x,I]=t.useState([]),[R,a]=t.useState(!1),[o,E]=t.useState({id:_}),d=()=>{f(l,!1),document.body.style.overflow="",y("")};return t.useEffect(()=>{L(J("userName"))},[]),t.useEffect(()=>{x.length>0&&d()},[x]),e.jsxs(e.Fragment,{children:[e.jsx(q,{closeHandler:d,title:g,type:h}),e.jsx("hr",{className:"m-0"}),e.jsx("div",{className:"container my-3",children:e.jsx("div",{className:"row py-0 pb-md-5",children:e.jsx("div",{className:"col-md-12 mb-5 mb-md-0",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"",children:e.jsx(Fe,{title:b,project:o,updated_by:A,category:S,gallerysetState:I,maxFiles:1,galleryState:x,validTypes:"image/png,image/jpeg",descriptionTitle:"Caption",titleTitle:"Title",alternitivetextTitle:"SEO title",saveState:a,showDescription:U,buttonLable:"Save",editImage:S,setEditCarousel:y,imagePostURL:u,imageUpdateURL:s,extraFormParamas:r,showExtraFormFields:c,dimensions:P,closeHandler:d,scrollEnable:j})})})})})})]})};function Le({editHandler:f,componentType:l,componentTitle:g,editObject:r,setEditState:c,setSaveState:b,dynamicFormFields:u=[],formPostURL:w,formUpdateURL:s,formDeleteURL:i}){const p=()=>{c(!1),f(l,!1),document.body.style.overflow=""},[h,S]=t.useState(!1),{register:y,reset:U,handleSubmit:P,formState:{errors:j}}=oe({defaultValues:t.useMemo(()=>r,[r])}),[_,A]=t.useState(""),L=ce(),x=async a=>{JSON.stringify(a);let o=new FormData;Object.keys(a).forEach(m=>{var F;m==="category_fileuplod"?o.append(m,typeof a[m]!="string"&&((F=a[m])==null?void 0:F.length)>0?a[m][0]:""):o.append(m,a[m])});let d="";const N={"Content-Type":"multipart/form-data"};try{a!=null&&a.id?(o.append("updated_by",J("userName")),d=await C.patch(`${s}${a.id}/`,o,{headers:N})):(o.append("created_by",J("userName")),d=await C.post(w,o,{headers:N})),b(d.data.category),p()}catch(m){O.error(m[0])}},I=a=>{const o=document.createElement("a");o.download=r.category_name,o.href=L+a,o.target="_blank",o.click()},R=a=>{const{id:o,category_name:E}=a,d=JSON.parse(JSON.stringify(a));d.category_fileuplod="";const N=async()=>{const m=await C.patch(`${i}${o}/`,d);m&&console.log(m)};K.confirmAlert({customUI:({onClose:m})=>e.jsx(W,{onClose:m,callback:N,message:`deleting the ${E} image?`})})};return e.jsxs(e.Fragment,{children:[e.jsx(q,{closeHandler:p,title:g}),e.jsx("hr",{}),e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-md-12 px-5",children:[h&&e.jsx("div",{className:"fw-bold",children:h&&e.jsx(De,{children:h})}),e.jsxs("form",{onSubmit:P(x),children:[Object.keys(u).map((a,o)=>{var F;const{label:E,type:d,fieldName:N,value:m}=u[a];return d=="richText"?e.jsx(ie,{label:E,editorSetState:A,initialText:""},o):e.jsx(le,{label:E,type:d,value:m,error:(F=j==null?void 0:j[N])==null?void 0:F.message,fieldName:N,register:y,...u[a]},o)}),r!=null&&r.category_fileuplod?e.jsxs("div",{className:"text-end",children:[e.jsxs(z,{className:"moreLink ",onClick:()=>I(r==null?void 0:r.category_fileuplod),children:["Download File"," ",e.jsx("i",{className:"fa fa-download ms-1 fs-5 rounded-2 p-2 border border-1 border-info bg-white","aria-hidden":"true"})]}),e.jsx(z,{to:"",onClick:()=>R(r),children:e.jsx("i",{className:"fa fa-trash-o ms-2 fs-5 rounded-1 p-1 text-danger","aria-hidden":"true"})})]}):"",e.jsxs("div",{className:"d-flex justify-content-center flex-wrap flex-column flex-sm-row align-items-center gap-1 gap-md-3 mt-5",children:[e.jsx("button",{className:"btn btn-secondary mx-3",children:"save"}),e.jsx(B,{type:"submit",cssClass:"btn btn-outline",label:"Close",handlerChange:p})]})]})]})})})]})}const Oe=()=>{const{id:f}=de(),l={banner:!1,briefIntro:!1,category:!1,product:!1};t.useRef(!0);const{isAdmin:g,hasPermission:r}=me(),[c,b]=t.useState(l),[u,w]=t.useState(!1),[s,i]=t.useState(""),[p,h]=t.useState(""),[S,y]=t.useState([]),[U,P]=t.useState(!1),[j,_]=t.useState("products"),[A,L]=t.useState("Add Product"),[x,I]=t.useState([]),[R,a]=t.useState({}),[o,E]=t.useState(!1),[d,N]=t.useState(""),[m,F]=t.useState(1),X=Y(),{categories:$}=V(n=>n.categoryList),T=(n,v,D)=>{D?(h(D),L(`${s==null?void 0:s.category_name} > ${D.product_name} - Edit Product`)):L(`${s==null?void 0:s.category_name} - Add New Product`),b(k=>({...k,[n]:v})),w(!u),document.body.style.overflow="hidden"},H=n=>{var v;if(((v=n==null?void 0:n.results)==null?void 0:v.length)>0){const D=he(n.results,"created_at");I(D),a(xe(n)),F(1)}else I([])};t.useEffect(()=>{if($.length>0){y($);let n="";s!=null&&s.id?n=$.filter(v=>v.id===s.id)[0]:f?n=$.filter(v=>v.id===f)[0]:n=$[0],i(n),_(n!=null&&n.id?n==null?void 0:n.id:j)}},[$,f]),t.useEffect(()=>{X(ue())},[!c.category]),t.useEffect(()=>{_(s!=null&&s.id?s==null?void 0:s.id:j)},[s]);const Z=()=>{P(!0),T("category",!0)},ee=()=>{const n=s==null?void 0:s.id,v=async()=>{if((await C.delete(`/products/updateCategory/${n}/`)).status===204){const k=S.filter(te=>te.id!==n);y(k),i(k.length>0?k[0]:""),O.success(`${s==null?void 0:s.category_name} is deleted`)}};K.confirmAlert({customUI:({onClose:D})=>e.jsx(W,{onClose:D,callback:v,message:`Do you want to delete the ${s==null?void 0:s.category_name} ?`})})},[G,se]=t.useState(window.innerWidth<=768);return t.useEffect(()=>{const n=()=>se(window.innerWidth<=768);return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),e.jsxs(e.Fragment,{children:[g&&r&&e.jsx("div",{className:"container py-4",children:e.jsx("div",{className:"row ",children:e.jsxs("div",{className:"col-md-12 d-flex justify-content-end align-items-center gap-2",children:[e.jsx("span",{children:e.jsx(Q,{title:"CATEGORY - ",cssClass:"fw-medium fs-6"})}),e.jsx(B,{type:"button",cssClass:"btn btn-secondary w-auto",label:"Create",icon:"fa-plus fs-5",isMobile:G,handlerChange:()=>{T("category",!0)}}),(s==null?void 0:s.id)&&e.jsx(B,{type:"button",cssClass:"btn btn-more w-auto",label:"Edit",icon:"fa-pencil fs-5",isMobile:G,handlerChange:Z}),(s==null?void 0:s.id)&&e.jsx(B,{type:"button",cssClass:"btn bg-danger text-white w-auto",label:"Delete",icon:"fa-trash-o fs-5",isMobile:G,handlerChange:ee})]})})}),c.category&&e.jsx("div",{className:"adminEditTestmonial selected ",children:e.jsx(Le,{editHandler:T,componentTitle:"Crete New Category",componentType:"category",editObject:U?s:"",setEditState:P,setSaveState:i,dynamicFormFields:ye(),formPostURL:"/products/createCategory/",formUpdateURL:"/products/updateCategory/"})}),(s==null?void 0:s.id)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"position-relative",children:[g&&r&&e.jsx(pe,{editHandler:()=>T("banner",!0)}),e.jsx(ge,{getBannerAPIURL:`banner/clientBannerIntro/${j}-banner/`,bannerState:c.banner,bannerContainerCss:"titleCaption d-flex align-items-end justify-content-center flex-column"})]}),c.banner&&e.jsx("div",{className:"adminEditTestmonial selected ",children:e.jsx(je,{editHandler:T,componentType:"banner",popupTitle:"Products Banner",pageType:`${j}-banner`,imageLabel:"Category Banner Image",showDescription:!1,showExtraFormFields:ve(`${j}-banner`),dimensions:M("banner")})})]}),e.jsxs(Se,{children:[e.jsx(Re,{category:S,selectedCategory:s,setResponseData:H,setSelectedCategory:i,setPageloadResults:E,setSearchquery:N,searchQuery:d,searchBy:"Search By Product Name",hideSearchBy:!1}),e.jsx("div",{}),e.jsxs("div",{className:"container productsList pt-5",children:[e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-md-12 col-lg-6 d-flex justify-content-center justify-content-md-start mb-3 mb-md-0 align-items-center",children:[e.jsx(Q,{title:`CATEGORY -> ${s==null?void 0:s.category_name}`,cssClass:"fw-medium fs-4"})," "]}),e.jsxs("div",{className:"col-md-12 col-lg-6 d-flex flex-column flex-sm-row justify-content-end align-items-center gap-3",children:[(s==null?void 0:s.id)&&g&&r&&e.jsx(B,{type:"button",cssClass:"btn btn-secondary w-auto",label:" Add Product",icon:"fa-plus",handlerChange:()=>{T("product",!0)}}),e.jsxs("div",{children:[x==null?void 0:x.length," of"," ",e.jsx("strong",{children:x==null?void 0:x.length})]}),e.jsx("span",{className:"d-none d-md-block",children:" | "}),e.jsx("div",{className:"d-flex justify-content-end align-items-center gap-1",children:e.jsxs("select",{className:"form-select","aria-label":"Default select example",children:[e.jsx("option",{selected:!0,children:"show"}),e.jsx("option",{value:"1",children:"5"}),e.jsx("option",{value:"2",children:"10"}),e.jsx("option",{value:"3",children:"25"}),e.jsx("option",{value:"3",children:"50"}),e.jsx("option",{value:"3",children:"75"}),e.jsx("option",{value:"3",children:"100"})]})}),e.jsx("span",{className:"d-none d-md-block",children:" | "}),e.jsx("div",{children:e.jsxs(z,{className:"moreLink ",children:["File",e.jsx("i",{className:"fa fa-download ms-1 fs-5 rounded-2 p-1 border border-1 border-info bg-white","aria-hidden":"true"})]})})]})]}),(s==null?void 0:s.id)&&e.jsx(Ie,{compState:c.product,selectedCategory:s,editHandler:T,setResponseData:H,productsList:x,setProductsList:I})]}),c.product&&e.jsx("div",{className:"adminEditTestmonial selected ",children:e.jsx(Ue,{editHandler:T,componentType:"product",popupTitle:"Product",componentTitle:A,selectedItem:p,setSelectedItemState:h,imageGetURL:`/products/createProduct/${s.id}/`,imagePostURL:"/products/createProduct/",imageUpdateURL:"/products/updateProduct/",imageDeleteURL:"/products/updateProduct/",imageLabel:"Product Image",showDescription:!1,showExtraFormFields:we(s),dimensions:M("product")})}),e.jsx("div",{children:R!=null&&R.total_count?e.jsx(Te,{paginationData:R,paginationURL:`/products/getClinetProduct/${s.id}/`,paginationSearchURL:d?`products/productSearch/${d}/`:`/products/getClinetProduct/${s.id}/`,searchQuery:d,setCurrentPage:F,currentPage:m,setResponseData:H,pageLoadResult:o}):""}),(s==null?void 0:s.id)&&e.jsx(e.Fragment,{}),(s==null?void 0:s.id)&&e.jsx(e.Fragment,{children:e.jsx(Pe,{children:e.jsx("div",{className:"container-lg px-0  productForm",children:e.jsx("div",{className:"row py-4",children:e.jsx(Ee,{col1:"col-md-5 p-lg-5 ps-lg-0 d-none d-md-block",col2:"col-md-7 px-4 p-lg-5 d-flex justify-content-center align-items-start flex-column",cssClass:"fs-3 text-center fw-medium title",imageClass:"w-100 h-100 object-fit-cover rounded-end rounded-end-5",dimensions:M("whoweare"),pageType:"products-Abrief",componentFlip:!1,showForm:!0,categoryId:s.id})})})})})]}),u&&e.jsx(fe,{})]})};export{Oe as default};
