import{F as P,r as l,o as z,j as e,T as G,B as S,P as J,L as $,c as f,au as Q,d as g}from"./index-BWK7iHxT.js";import{C as V}from"./CatageoryImgC-B5Y-umQ5.js";import{F as W}from"./FileUpload-BBAUjrX2.js";import{l as X}from"./DeleteDialog-DnRfuXBp.js";import{D as Y}from"./DeleteDialog-sO22D6fc.js";import{E as Z}from"./Error-B_8W099F.js";import{v as B}from"./v4-CtRu48qb.js";const ce=()=>{const F=P(),[r,d]=l.useState([]),[n,y]=l.useState({id:B()}),x={title:"",description:""},[o,h]=l.useState(x),[w,p]=l.useState(""),[m,u]=l.useState(!1),[N,v]=l.useState(""),[j,k]=l.useState(""),[M,D]=l.useState(!1),C=J(),[O,_]=l.useState(!1);l.useEffect(()=>{k(z("userName"))},[]);const U=t=>{p(""),h({...o,[t.target.name]:t.target.value})},E=()=>B(),A=()=>{h(x),y({id:E()}),u(!1),d([]),v(0)},[b,I]=l.useState([]),T=async()=>{var s,c;const t=await f.get("/testimonials/createTestimonials/");if((t==null?void 0:t.status)===200&&((c=(s=t.data)==null?void 0:s.testimonial)==null?void 0:c.length)>0){const i=t.data.testimonial,a=Q(i);I(a)}else I([])};l.useEffect(()=>{T()},[]),l.useEffect(()=>{r.length>0?D(!0):D(!1)},[r]);const L=async()=>{var s,c,i;if(o.title===""){p("Please add testimonial title");return}if(o.description===""){p("Please add testimonial description");return}const t={projectID:n.id,title:o.title,description:o.description,imageId:(s=r[0])!=null&&s.id?r[0].id:null,originalname:(c=r[0])!=null&&c.originalname?r[0].originalname:null,imageUrl:(i=r[0])!=null&&i.path?r[0].path:null,updated_by:j,id:N,created_by:n!=null&&n.created_by?n==null?void 0:n.created_by:j};try{let a="";m?(t.updated_by=j,a=await f.put(`/testimonials/updateTestimonials/${N}/`,{...t})):a=await f.post("/testimonials/createTestimonials/",{...t}),(a==null?void 0:a.status)===200||(a==null?void 0:a.status)===201?(g.success(`${o.title} news ${m?"Update":"created"}`),u(!1),h(x),y({id:E()}),d([]),T(),v(0)):p(a.data.message)}catch{g.error("Unable to save the testimonial")}},R=(t,s)=>{t.preventDefault();const{projectID:c,description:i,title:a,id:H}=s;d([]);const K={title:a,description:i};y({id:c,category:"testimonial"}),h(K),u(!0),v(H),window.scrollTo(0,0)},q=(t,s)=>{t.preventDefault();const c=async()=>{try{const i=await f.delete(`/testimonials/updateTestimonials/${s.id}/`);i.status!==204&&(p(i.data.message),g.error("Unable to Delete testimonial")),i.status===204&&(g.success(`${s.title} testimonial deleted`),u(!1),h(x),d([]),T())}catch{g.error("Unable to Delete testimonial")}};X.confirmAlert({customUI:({onClose:i})=>e.jsx(Y,{onClose:i,callback:c,message:`deleting the ${s.title} testimonial?`})})};return e.jsxs("div",{className:"container-fluid pt-5",style:{marginTop:"120px"},children:[e.jsx("div",{className:"row px-3 px-md-3",children:e.jsxs("div",{className:"text-end d-flex justify-content-between",children:[e.jsx(G,{title:"Testimonial",cssClass:"text-center blue-500 fs-4"}),e.jsx(S,{type:"submit",cssClass:"btn btn-secondary",label:"Back to Menu",handlerChange:()=>F("/main")})]})}),e.jsxs("div",{className:"row px-3 px-md-3 mt-4",children:[e.jsx("div",{className:"col-12 col-md-5 col-lg-4",children:e.jsxs("div",{className:`${m?"editModeBorder":"border border-1"}  p-4 mb-4 bg-light shadow-lg`,children:[w&&e.jsx(Z,{children:w}),m?e.jsx("div",{className:"mb-2 text-center fs-5 blue-500 ",children:"Edit Mode"}):"",e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"projectDescription",className:"form-label fw-normal ",children:["Testimonial Title ",e.jsx("span",{className:"text-danger",children:" *"})]}),e.jsx("input",{type:"text",className:"form-control",name:"title",value:o.title,onChange:U,id:"title"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"projectDescription",className:"form-label fw-normal ",children:["Testimonial Description ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("textarea",{className:"form-control",name:"description",value:o.description,onChange:U,id:"projectDescription",rows:"3"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(W,{title:"Testimonial Images",project:n,updatedBy:j,category:"testimonial",gallerysetState:d,galleryState:r,validTypes:"image/png,image/jpeg",disabledFile:M,descriptionTitle:"",showDescription:!1,saveState:_,maxFiles:1}),e.jsx(V,{title:"Testimonial Image",catategoryImgs:r,catategoryImgState:d,project:n,category:"testimonial",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5 fs-2"})]}),e.jsxs("div",{className:"text-center",children:[m?e.jsx(S,{type:"submit",cssClass:"btn btn-secondary me-3",label:"Cancel",handlerChange:A}):"",e.jsx(S,{type:"submit",disabled:O,cssClass:"btn btn-primary",label:m?"Update Testimonial":"Save Testimonial",handlerChange:L})]})]})}),e.jsx("div",{className:"col-12 col-md-7 col-lg-8",children:b.length>0?e.jsx("div",{className:"row px-2 table-responsive",children:e.jsxs("table",{className:"table table-hover border align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"News Title"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:b==null?void 0:b.map(t=>e.jsxs("tr",{className:`${t.id===N?"editModeBorder":""}`,children:[e.jsx("td",{className:"description",children:e.jsx("span",{className:"m-0",children:t.title})}),e.jsx("td",{className:"description",children:e.jsx("p",{className:"m-0",children:t.description})}),e.jsxs("td",{children:[" ",t!=null&&t.imageUrl?e.jsx("img",{width:"60",height:"60",src:`${C}${t.imageUrl}`,alt:" "}):e.jsx("img",{width:"60",height:"60",src:`${C}/media/images/dummy-image-square.png`,alt:""})," "]}),e.jsxs("td",{className:"valign-middle",children:[e.jsx($,{onClick:s=>R(s,t),children:e.jsx("i",{className:"fa fa-pencil-square-o fs-4 text-secondary me-3","aria-hidden":"true"})}),e.jsx($,{onClick:s=>q(s,t),children:e.jsx("i",{className:"fa fa-trash-o fs-4 text-danger","aria-hidden":"true"})})]})]},t.id))})]})}):""})]})]})};export{ce as AdminTestimonial,ce as default};
