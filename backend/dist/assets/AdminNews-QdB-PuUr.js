import{F as q,r,o as H,j as e,T as K,B as D,P as z,L as E,c as u,au as G,d as p}from"./index-BWK7iHxT.js";import{C as J}from"./CatageoryImgC-B5Y-umQ5.js";import{F as Q}from"./FileUpload-BBAUjrX2.js";import{l as V}from"./DeleteDialog-DnRfuXBp.js";import{D as W}from"./DeleteDialog-sO22D6fc.js";import{E as X}from"./Error-B_8W099F.js";import{v as A}from"./v4-CtRu48qb.js";const le=()=>{const B=q(),[d,l]=r.useState([]),[N,b]=r.useState({id:A()}),h={newstitle:"",description:""},[a,o]=r.useState(h),[S,m]=r.useState(""),[c,g]=r.useState(!1),[f,w]=r.useState(0),[x,T]=r.useState(""),U=z(),[k,F]=r.useState(!1);r.useEffect(()=>{T(H("userName"))},[]);const C=()=>A(),I=s=>{m(""),o({...a,[s.target.name]:s.target.value})},M=()=>{o(h),b({id:C()}),g(!1),l([]),w(0)},[j,$]=r.useState([]),y=async()=>{var t,n;const s=await u.get("/appNews/createAppNews/");if((s==null?void 0:s.status)===200&&((n=(t=s.data)==null?void 0:t.appNews)==null?void 0:n.length)>0){const i=s.data.appNews,v=G(i);$(v)}else $([])};r.useEffect(()=>{y()},[]);const O=async()=>{if(a.newstitle===""){m("Please add title");return}if(a.description===""){m("Please add description");return}const s={projectID:N.id,newstitle:a.newstitle,description:a.description,imageIds:d.map(function(t){return t.id}),originalnames:d.map(function(t){return t.originalname}),imageUrls:d.map(function(t){return t.path}),updated_by:x,created_by:a!=null&&a.created_by?a==null?void 0:a.created_by:x,id:f};try{let t="";c?(s.updated_by=x,t=await u.put(`/appNews/updateAppNews/${f}/`,{...s})):t=await u.post("/appNews/createAppNews/",{...s}),(t==null?void 0:t.status)===200||(t==null?void 0:t.status)===201?(p.success(`${a.newstitle} news ${c?"Update":"created"}`),g(!1),o(h),b({id:C()}),l([]),y(),w(0)):m(t.data.message)}catch{p.error("Unable to save the news")}},P=(s,t)=>{s.preventDefault();const{projectID:n,description:i,newstitle:v,id:L}=t;l([]);const R={newstitle:v,description:i};b({id:n,category:"news"}),o(R),g(!0),w(L),window.scrollTo(0,0)},_=(s,t)=>{s.preventDefault();const n=async()=>{try{const i=await u.delete(`/appNews/updateAppNews/${t.id}/`);i.status!==204&&(m(i.data.message),p.error("Unable to Delete news")),i.status===204&&(p.success(`${t.newstitle} news deleted`),g(!1),o(h),l([]),y())}catch{p.error("Unable to Delete news")}};V.confirmAlert({customUI:({onClose:i})=>e.jsx(W,{onClose:i,callback:n,message:`deleting the ${t.newstitle} news?`})})};return e.jsxs("div",{className:"container-fluid pt-5",style:{marginTop:"100px"},children:[e.jsx("div",{className:"row px-3",children:e.jsxs("div",{className:"text-end d-flex justify-content-between",children:[e.jsx(K,{title:"News And Update",cssClass:"text-center blue-500 fs-4"}),e.jsx(D,{type:"submit",cssClass:"btn btn-secondary",label:"Back to Menu",handlerChange:()=>B("/main")})]})}),e.jsxs("div",{className:"row px-3 mt-4 ",children:[e.jsx("div",{className:"col-12 col-md-5 col-lg-4 ",children:e.jsxs("div",{className:`${c?"editModeBorder":"border border-1"}  p-4 mb-4 bg-light shadow-lg`,children:[S&&e.jsx(X,{children:S}),c?e.jsx("div",{className:"mb-2 text-center fs-5 blue-500 ",children:"Edit Mode"}):"",e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"projectDescription",className:"form-label  ",children:["News Title ",e.jsx("span",{className:"text-danger",children:" *"})]}),e.jsx("input",{type:"text",className:"form-control",name:"newstitle",value:a.newstitle,onChange:I,id:"newstitle"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"projectDescription",className:"form-label  ",children:["News Description ",e.jsx("span",{className:"text-danger",children:" *"})]}),e.jsx("textarea",{className:"form-control",name:"description",value:a.description,onChange:I,id:"projectDescription",rows:"3"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(Q,{title:"News Images (Upload multiple images)",project:N,updatedBy:x,category:"news",gallerysetState:l,galleryState:d,saveState:F,validTypes:"image/png,image/jpeg"}),e.jsx(J,{title:"News Image",catategoryImgs:d,catategoryImgState:l,project:N,category:"news",cssClass:"thumb75 mb-5 shadow-lg border border-5 border-warning rounded-5"})]}),e.jsxs("div",{className:"text-center",children:[c?e.jsx(D,{type:"submit",cssClass:"btn btn-secondary me-3",label:"Cancel",handlerChange:M}):"",e.jsx(D,{type:"submit",disabled:k,cssClass:"btn btn-primary",label:c?"Update News":"Save News",handlerChange:O})]})]})}),e.jsx("div",{className:"col-12 col-md-7 col-lg-8",children:j.length>0?e.jsx("div",{className:"row px-2 table-responsive",children:e.jsxs("table",{className:"table table-hover border align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"News Title"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:j==null?void 0:j.map(s=>e.jsxs("tr",{className:`${s.id===f?"editModeBorder":""}`,children:[e.jsx("td",{className:"description",children:e.jsxs("span",{className:"m-0",children:[s.newstitle," "]})}),e.jsx("td",{className:"description",children:e.jsx("p",{className:"m-0",children:s.description})}),e.jsxs("td",{children:[" ",(s==null?void 0:s.imageUrls.length)>0?e.jsxs(e.Fragment,{children:[e.jsx("img",{width:"60",height:"60",src:`${U}${s.imageUrls[0]}`,alt:" "})," ",e.jsx("span",{className:"badge text-bg-secondary",children:(s==null?void 0:s.imageUrls.length)>1?`${s==null?void 0:s.imageUrls.length} img's`:""})]}):e.jsx("img",{width:"60",height:"60",src:`${U}/media/images/dummy-image-square.png`,alt:""})," "]}),e.jsxs("td",{children:[e.jsx(E,{onClick:t=>P(t,s),children:e.jsx("i",{className:"fa fa-pencil-square-o fs-4 text-muted me-3","aria-hidden":"true"})}),e.jsx(E,{onClick:t=>_(t,s),children:e.jsx("i",{className:"fa fa-trash-o fs-4 text-danger","aria-hidden":"true"})})]})]},s.id))})]})}):""})]})]})};export{le as AdminNews,le as default};
