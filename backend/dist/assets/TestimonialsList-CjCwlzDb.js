import{p as K,f as z,e as G,r as i,j as e,k as v,T as N,L as D,g as V,a8 as W,M as X,b as Y,$ as Z,Q as ee,t as se,v as te,c as I,d as ae}from"./index-BWK7iHxT.js";import{B as ie}from"./index-Zr8zxzfx.js";import"./Styled-BriefIntro-DpTy6njT.js";import{I as ne}from"./ImgTitleIntoForm-bGCGObUS.js";import{i as P,c as oe,b as le}from"./dynamicFormFields-JEId_5aT.js";import{l as re}from"./DeleteDialog-DnRfuXBp.js";import{D as ce}from"./DeleteDialog-sO22D6fc.js";import{N as de}from"./index-C4YU0TO1.js";import{S as me}from"./index-D85sR-zM.js";import{C as pe}from"./CustomPagination-CzwkxU7w.js";import{S as ge}from"./SkeletonImage-DKfKqy0G.js";import{D as ue,C as xe,P as he}from"./dnd.esm-DtnQK6qL.js";import"./Styled-PageBanner-gSpUsEd9.js";import"./FileUpload-BBAUjrX2.js";import"./Error-B_8W099F.js";const fe=K.div`

  .testimonialsPage hr:last-child {
    display: none;
  }
  .testimonialAvatar img {
    max-width: 150px;
    max-height: 150px;
  }
`,Ae=()=>{const R={banner:!1,briefIntro:!1,addSection:!1,editSection:!1,testmonial:!1},x="testimonial",{isLoading:y}=z(t=>t.loader),{isAdmin:r,hasPermission:h}=G(),[n,E]=i.useState(R),[m,f]=i.useState([]),[p,b]=i.useState(!1),[A,j]=i.useState({}),[S,L]=i.useState(!1),[g,U]=i.useState({}),[$,F]=i.useState(!1),[u,_]=i.useState(""),[B,T]=i.useState(1),[M,k]=i.useState({}),w=t=>{f(t.results.length>0?Z(t.results):[]),U(ee(t)),T(1)};i.useEffect(()=>{const t=async()=>{try{const a=await Y.get("/testimonials/clientTestimonials/");(a==null?void 0:a.status)===200&&w(a.data)}catch{console.log("unable to access ulr because of server is down")}};(!n.addSection||!n.editSection)&&t()},[n.addSection,n.editSection]),i.useEffect(()=>{const t=document.getElementById("KnowledgeHubnavbarDropdown");t&&t.classList.add("active")});const d=(t,a,s)=>{E(o=>({...o,[t]:a})),b(!p),s!=null&&s.id?j(s):j({}),document.body.style.overflow="hidden"},H=t=>{const a=t.id,s=t.testimonial_title,o=async()=>{if((await I.delete(`/testimonials/updateTestimonials/${a}/`)).status===204){const c=m.filter(J=>J.id!==a);f(c),ae.success(`${s} is deleted`)}};re.confirmAlert({customUI:({onClose:l})=>e.jsx(ce,{onClose:l,callback:o,message:`deleting the ${s} Service?`})})},C=t=>{k(t),b(!p),L(!S)},O=()=>{L(!S),b(!p)},Q=async t=>{const{source:a,destination:s}=t;if(!s)return!0;const o=se(m,a.index,s.index),l=te(o,"testimonial_position"),c=await q(l);(c==null?void 0:c.length)>0&&f(c)},q=async t=>{var a;try{let s=await I.put("/testimonials/updateTestimonialsindex/",t);if((a=s==null?void 0:s.data)!=null&&a.testimonial)return s.data.testimonial}catch{console.log("unable to save news position")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"position-relative",children:[r&&h&&e.jsx(v,{editHandler:()=>d("banner",!0)}),e.jsx(ie,{getBannerAPIURL:`banner/clientBannerIntro/${x}-banner/`,bannerState:n.banner})]}),n.banner&&e.jsx("div",{className:"adminEditTestmonial selected ",children:e.jsx(ne,{editHandler:d,componentType:"banner",popupTitle:"Testimonial",pageType:`${x}-banner`,imageLabel:"Banner Image",showDescription:!1,showExtraFormFields:oe(`${x}-banner`),dimensions:P("banner")})}),e.jsxs("div",{className:"container-fluid container-lg my-md-5 ",children:[e.jsx("div",{className:"row",children:r&&h&&e.jsx("div",{className:"col-md-12",children:e.jsx("div",{className:"d-flex justify-content-end align-items-center mb-3",children:e.jsxs("button",{type:"submit",className:"btn btn-primary px-3",onClick:()=>d("addSection",!0,{}),children:["Add New Testimonials"," ",e.jsx("i",{className:"fa fa-plus ms-2","aria-hidden":"true"})]})})})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-6 d-flex align-items-center",children:e.jsx(N,{title:"Testimonials",cssClass:"fw-medium pageTitle"})}),e.jsx("div",{className:"col-md-6",children:e.jsx(me,{setObject:w,clientSearchURL:"/testimonials/searchtestimonials/",adminSearchURL:"/testimonials/createTestimonials/",clientDefaultURL:"/testimonials/clientTestimonials/",searchfiledDeatails:"client Title / client description ",setPageloadResults:F,setSearchquery:_,searchQuery:u})})]}),n.editSection||n.addSection?e.jsx("div",{className:"adminEditTestmonial selected ",children:e.jsx(de,{editHandler:d,category:"about",popupTitle:"Testimonial",editCarousel:A,setEditCarousel:j,componentType:`${n.editSection?"editSection":"addSection"}`,getImageListURL:"testimonials/clientTestimonials/",deleteImageURL:"testimonials/updateTestimonials/",imagePostURL:"testimonials/createTestimonials/",imageUpdateURL:"testimonials/updateTestimonials/",imageLabel:"Image",showDescription:!1,showExtraFormFields:le("testmonial"),dimensions:P("testimonial")})}):"",e.jsx(fe,{children:e.jsxs("div",{className:"testimonialsPage my-5",children:[y?e.jsx("div",{className:"row",children:[1,2,3,4].map((t,a)=>e.jsx("div",{className:"col-12",children:e.jsx(ge,{})},a))}):"",e.jsx(ue,{onDragEnd:Q,children:e.jsx(xe,{droppableId:"NewsList",id:"newsList",children:(t,a)=>e.jsxs("div",{className:"row",ref:t.innerRef,...t.droppableProps,children:[m.length>0?m.map((s,o)=>e.jsx(he,{isDragDisabled:!r,index:o,draggableId:s.id,id:s.id,children:l=>e.jsx("div",{ref:l.innerRef,...l.draggableProps,...l.dragHandleProps,children:e.jsxs("div",{className:`row mb-2 ${r?"border border-warning mb-3 position-relative":""} ${o%2===0?"normalCSS":"flipCSS"}`,children:[r&&h&&e.jsxs(e.Fragment,{children:[e.jsx(v,{editHandler:()=>d("editSection",!0,s)}),e.jsx(v,{icon:"fa-trash-o",iconCss:"text-danger fs-4",cssClasses:"",editHandler:()=>H(s)})]}),e.jsxs("div",{className:"col-12 col-lg-10 p-3 p-md-4 py-md-4 d-flex justify-content-center align-items-start flex-column",children:[s.testimonial_title?e.jsx(N,{title:s.testimonial_title,cssClass:"fs-1 fw-bold mb-1"}):"",e.jsx("div",{dangerouslySetInnerHTML:{__html:s.testimonial_description}})]}),e.jsx("div",{className:"col-lg-2 d-none d-lg-block h-100",children:e.jsx("div",{className:"h-100 p-3 p-md-5 py-md-4 testimonialAvatar ",children:e.jsx(D,{to:"",className:"text-decoration-underline",onClick:()=>C(s),children:e.jsx("img",{src:V(s.path),alt:"",className:"img-fluid rounded-circle border border-3 border-light shadow-lg img-thumbnail "})})})}),e.jsx(D,{to:"",className:"btn btn-outline w-auto mx-4 text-decoration-underline d-flex d-lg-none",onClick:()=>C(s),children:"More"})]},s.id)},s.id)},s.id)):e.jsx("p",{className:"text-center text-muted py-5",children:!y&&e.jsx("span",{children:"Please add page contents..."})}),t.placeholder]})})})]})}),g!=null&&g.total_count?e.jsx(pe,{paginationData:g,paginationURL:r?"/client/createClientLogo/":"/client/getAllClientLogos/",paginationSearchURL:u?`/client/searchClientLogos/${u}/`:r?"/client/createClientLogo/":"/client/getAllClientLogos/",searchQuery:u,setCurrentPage:T,currentPage:B,setResponseData:w,pageLoadResult:$}):""]}),S&&e.jsx(W,{obj:M,privacy:"",closeModel:O,flag:"footer"}),p&&e.jsx(X,{})]})};export{Ae as default};
